<!DOCTYPE html>

<html>
    <head>
        <title>Rock, Paper, Scissors</title>
    </head>
    <body>
        <h2>Let's play Rock, paper, scissors. Press a button to play the computer and see if you win. Or play a game (best of 5)!</h2>
        <button id="rock">Rock</button>
        <button id="paper">Paper</button>
        <button id="scissors">Scissors</button>
        <div>
            <p id="round"></p>
            <p id="game"></p>
            <p id="result"></p>
        </div>
        <script>
            let playerScore = 0;
            let computerScore = 0;
            let round = 1;

            document.getElementById('round').textContent = `Round ${round}/5: `;
            document.getElementById('game').textContent = `Player score: ${playerScore}, Computer score: ${computerScore}. `;

            const rockButton = document.getElementById('rock');
            rockButton.addEventListener('click', () => {
                playRound('rock', computerPlay());
            });

            const paperButton = document.getElementById('paper');
            paperButton.addEventListener('click', () => {
                playRound('paper', computerPlay());
            });

            const scissorsButton = document.getElementById('scissors');
            scissorsButton.addEventListener('click', () => {
                playRound('scissors', computerPlay());
            });

            function randomChoice() {
                return Math.floor(Math.random() * 3);
            }

            function computerPlay() {
                let choice = randomChoice();

                switch (choice) {
                    case 0:
                        return 'rock';
                        break;
                    case 1:
                        return 'paper';
                        break;
                    case 2:
                        return 'scissors';
                        break;
                }
            }

            function playRound(playerSelection, computerSelection) {
                let roundText = `Round ${round}/5: `;
                document.getElementById('result').textContent = "";

                if (playerSelection === computerSelection) {
                    roundText += 'It\'s a draw!';
                    document.getElementById('round').textContent = roundText;
                    let gameText = `Player score: ${playerScore}, Computer score: ${computerScore}. `;
                    document.getElementById('game').textContent = gameText;
                    round++;
                    if (isGameOver()) {
                        document.getElementById('result').textContent = isGameOver();

                        playerScore = 0;
                        computerScore = 0;
                        round = 1;
                    }
                    return;
                }

                switch (playerSelection) {
                    case 'rock':
                        if (computerSelection === 'paper') {
                            computerScore++;
                            roundText += 'You lose! Paper beats rock.';
                            break;
                        }
                        playerScore++;
                        roundText += 'You win! Rock beats scissors';
                        break;
                    case 'paper':
                        if (computerSelection === 'scissors') {
                            computerScore++
                            roundText += 'You lose! Scissors beats paper.';
                            break;
                        }
                        playerScore++;
                        roundText += 'You win! Paper beats rock';
                        break;
                    case 'scissors':
                        if (computerSelection === 'rock') {
                            computerScore++;
                            roundText += 'You lose! Rock beats scissors.';
                            break;
                        }
                        playerScore++;
                        roundText += 'You win! scissors beats paper';
                        break;
                    default:
                        return 'That\'s not a valid play, you must press either rock, paper or scissors.';
                }
                document.getElementById('round').textContent = roundText;
                round++;
                let gameText = `Player score: ${playerScore}, Computer score: ${computerScore}. `;
                document.getElementById('game').textContent = gameText;

                if (isGameOver()) {
                    document.getElementById('result').textContent = isGameOver();

                    playerScore = 0;
                    computerScore = 0;
                    round = 1;
                }
            }

            function isGameOver() {
                if (round <= 5) {
                    return;
                }

                if (playerScore > computerScore) {
                    return "You win the game!";
                }
                else if (computerScore > playerScore) {
                    return "You lose the game! Tough luck.";
                }
                else {
                    return "The game ended in a tie!";
                }
            }
        </script>
    </body>
</html>